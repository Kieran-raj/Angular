<app-header-details [pageTitle]="pageTitle"></app-header-details>
<div class="px-2 col" style="height: 100%">
  <div class="card mt-2 mx-0 row" id="chart-columm">
    <div class="card-header">
      <h2 class="mb-0">Expenses Summary</h2>
    </div>
    <div class="container-fluid cardBody">
      <div class="row pt-2">
        <div class="col-auto pr-0">
          <app-line-chart
            *ngIf="chartMode === 'Daily'"
            [sourceData]="lineData"
            [xAxisTicks]="xAxisTicks"
            [activeEntries]="activeEntries"
            [isLoading]="isLineDataLoading"
            [customToolTipTemplate]="lineChartToolTipRef"
            [customSeriesTooltipTemplate]="lineChartSeriesToolTipRef"
          >
          </app-line-chart>
          <app-bar-chart
            *ngIf="chartMode === 'Monthly'"
            [sourceData]="barData"
            [customToolTipTemplate]="barChartToolTipRef"
          ></app-bar-chart>
        </div>
        <div class="col-1 pl-0" align="center">
          <app-expenses-side-bar
            class="pl-0"
            id="expenses-side-bar"
            [showDateSelection]="showDateSelection"
            (resetButton)="resetGraph()"
            (toggleMovingAverage)="toggleMovingAverage($event)"
            (dropDownValue)="dropDownChange($event)"
          ></app-expenses-side-bar>
        </div>

        <div class="col" id="pie-chart" align="center">
          <app-pie-chart [sourceData]="pieData"></app-pie-chart>
        </div>
        <div class="col"></div>
      </div>
    </div>
  </div>
  <div class="row">
    <div class="col-auto">
      <button
        class="btn btn-secondary mt-2 crudButton shadow-none"
        (click)="openModal(categoryModal, 'category-modal')"
      >
        New Category
      </button>
      <div *ngIf="false" style="color: green">{{ updateMessage }}</div>
    </div>
    <div class="col-auto">
      <button
        class="btn btn-secondary mt-2 crudButton shadow-none"
        (click)="openModal(transactionModal, 'transaction-modal')"
      >
        New Transaction
      </button>
    </div>
  </div>

  <div class="grid">
    <app-expenses-grid class="px-2 my-0 py-0"></app-expenses-grid>
  </div>
</div>

<ng-template #categoryModal>
  <app-expenses-create-modal
    [modal]="modal"
    [modalTitle]="modalTitle"
  ></app-expenses-create-modal>
</ng-template>

<ng-template #transactionModal>
  <app-expenses-create-modal
    [modal]="modal"
    [modalTitle]="modalTitle"
  ></app-expenses-create-modal>
</ng-template>

<ng-template #lineChartToolTipRef let-model="model">
  <app-expenses-line-chart-tooltip [model]="model">
  </app-expenses-line-chart-tooltip>
</ng-template>

<ng-template #lineChartSeriesToolTipRef let-model="model">
  <app-expenses-line-chart-tooltip [model]="model" [isSeriesTooltip]="true">
  </app-expenses-line-chart-tooltip>
</ng-template>

<ng-template #barChartToolTipRef let-model="model">
  <app-expenses-bar-chart-tooltip
    [model]="model"
  ></app-expenses-bar-chart-tooltip>
</ng-template>

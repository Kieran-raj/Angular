<app-header-details [pageTitle]="pageTitle"></app-header-details>
<div class="px-2 col" style="height: 100%">
  <div class="card mt-2 mx-0 row" id="chart-columm">
    <div class="card-header">
      <h2 class="mb-0">Expenses Summary</h2>
    </div>
    <div class="container-fluid cardBody">
      <div class="row pt-2">
        <div class="col-auto pr-0">
          <div class="row" id="chart-buttons">
            <div class="col-9 pl-0" id="chart-side-bar" align="center">
              <app-expenses-side-bar
                class="pl-0"
                id="expenses-side-bar"
                [showDateSelection]="showDateSelection"
                (resetButton)="resetGraph()"
                (toggleMovingAverage)="toggleMovingAverage($event)"
                (dropDownValue)="dropDownChange($event)"
              ></app-expenses-side-bar>
            </div>
            <div class="col-3" id="chart-new-buttons">
              <div class="row">
                <div class="col">
                  <button
                    class="btn btn-secondary crudButton shadow-none"
                    (click)="setModalAction('newCategory')"
                  >
                    New Category
                  </button>
                </div>
                <div class="col">
                  <button
                    class="btn btn-secondary crudButton shadow-none"
                    (click)="setModalAction('newTransaction')"
                  >
                    New Transaction
                  </button>
                </div>
              </div>
            </div>
          </div>
          <app-line-chart
            *ngIf="chartMode === 'Daily'"
            [sourceData]="lineData"
            [xAxisTicks]="xAxisTicks"
            [activeEntries]="activeEntries"
            [isLoading]="isLineDataLoading"
            [customToolTipTemplate]="lineChartToolTipRef"
            [customSeriesTooltipTemplate]="lineChartSeriesToolTipRef"
          >
          </app-line-chart>
          <app-bar-chart
            *ngIf="chartMode === 'Monthly'"
            [sourceData]="barData"
            [customToolTipTemplate]="barChartToolTipRef"
          ></app-bar-chart>
        </div>

        <div class="col" id="pie-chart" align="center">
          <app-pie-chart [sourceData]="pieData"></app-pie-chart>
        </div>
      </div>
    </div>
  </div>

  <div class="grid">
    <app-expenses-grid class="px-2 my-0 py-0"></app-expenses-grid>
  </div>
</div>

<ng-template #modal>
  <app-expenses-create-modal
    [modal]="modalInstance"
    [modalAction]="modalAction"
  ></app-expenses-create-modal>
</ng-template>

<ng-template #lineChartToolTipRef let-model="model">
  <app-expenses-line-chart-tooltip [model]="model">
  </app-expenses-line-chart-tooltip>
</ng-template>

<ng-template #lineChartSeriesToolTipRef let-model="model">
  <app-expenses-line-chart-tooltip [model]="model" [isSeriesTooltip]="true">
  </app-expenses-line-chart-tooltip>
</ng-template>

<ng-template #barChartToolTipRef let-model="model">
  <app-expenses-bar-chart-tooltip
    [model]="model"
  ></app-expenses-bar-chart-tooltip>
</ng-template>
